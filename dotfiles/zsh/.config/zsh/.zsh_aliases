# following https://www.thorsten-hans.com/5-types-of-zsh-aliases

# Simple aliases
alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."

# use gnu ls instad
alias ls="gls --color -alh --group-directories-first"
alias activate-venv="source .venv/bin/activate"

# Functions

# Docker - connect to a running container and start a bash session
docker-exec-bash() {
  docker exec -it $1 /bin/bash;
};

# Docker - Start Docker container and connect to it in bash session
docker-run-bash() {
  docker run -it $1 /bin/bash;
};

# Docker - Run a Docker container and forward all AWS environment variables
docker-run-with-aws-access(){
  docker run -it --env-file <(aws-vault exec $1 -- env | grep ^AWS_) $2
}

# Docker -  Remove all untagged images
docker-remove-none-images(){
    docker rmi -f $(docker images | grep '<none>' | sed  -E 's/[ ]+/,/g' | cut -f3 -d,)
}

# json <-> yaml conversion
yaml-to-json() {
	yq -P --output-format json $1
}
json-to-yaml() {
	yq -P $1
}
json-minify() {
	jq --compact-output < $1
}
json-maxify() {
	# uses two spaces by default
	jq < $1
}


# zinit update
zinit-update() {
  echo "Updating Zinit and plugins..."
  zinit self-update && zinit update --all
  echo "All Zinit plugins updated!"
}

# check login vs interactive - just for fun/learning
is-login-shell() {
	[[ -o login ]] && echo 'login' || echo 'non-login'
}
is-interactive-shell() {
	[[ $- == *i* ]] && echo 'interactive' || echo 'non-interactive'
}

# k9s
k9s-toogle-readonly() {
  CTX=$(kubectl config current-context)
  CLUSTER=$(kubectl config view --minify -o jsonpath='{.contexts[0].context.cluster}' | sed 's/[^a-zA-Z0-0]/-/g')
  yq -i '.k9s.readOnly |= not ' ${XDG_DATA_HOME}/k9s/clusters/${CLUSTER}/${CTX}/config.yaml
}
